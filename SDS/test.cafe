--> true
open INV .
	op a : -> Prin .
	op b : -> Prin .
	op k : -> Secret .
	op n : -> Nat .
	op s : -> Sys .
	red keySe(init,a,b,k,n) .
close

--> true
open INV .
	op a : -> Prin .
	op b : -> Prin .
	op k : -> Secret .
	op n : -> Nat .
	op r1 : -> Prin .
	op r2 : -> Prin .
	op r3 : -> Data .
	op s : -> Sys .
	eq (r3 \in knl(s)) = true .
	red keySe(s,a,b,k,n) implies keySe(fkmsg1(s,r1,r2,r3),a,b,k,n) .
close

--> true
open INV .
	op a : -> Prin .
	op b : -> Prin .
	op k : -> Secret .
	op n : -> Nat .
	op r1 : -> Prin .
	op r2 : -> Prin .
	op r3 : -> Data .
	op s : -> Sys .
	eq (r3 \in knl(s)) = false .
	red keySe(s,a,b,k,n) implies keySe(fkmsg1(s,r1,r2,r3),a,b,k,n) .
close